<?xml version="1.0" encoding="utf-8" ?>
<mapper>
	<select id="SelectBoardList">
		SELECT
			BOARDNO,
			BOARDTITLE,
			BOARDAUTHOR,
			BOARDVIEW
		FROM
			T_BOARD
		ORDER BY BOARDNO DESC
	</select>
	
	<insert id="InsertBoard">
		INSERT INTO T_BOARD(BOARDTITLE, BOARDAUTHOR, BOARDCONTENTS, CREATE_DATETIME, BOARDUSERID)
		VALUES (@BOARDTITLE, @BOARDAUTHOR, @BOARDCONTENTS, GETDATE(), @BOARDUSERID)
	</insert>

	<select id="SelectMaxBoardNo">
		SELECT MAX(BOARDNO) BOARDNO
		FROM T_BOARD;
	</select>
	
	<select id="SelectBoardDetail">
		SELECT 
			BOARDNO,
			BOARDTITLE,
			BOARDAUTHOR,
			BOARDVIEW,
			BOARDCONTENTS,
			CREATE_DATETIME,
			BOARDUSERID
		FROM 
			T_BOARD
		WHERE 
			BOARDNO = @BOARDNO
	</select>
	
	<update id="UpdateBoard">
		UPDATE T_BOARD
		SET 
			BOARDTITLE=@BOARDTITLE,
			BOARDCONTENTS=@BOARDCONTENTS
		WHERE BOARDNO=@BOARDNO
	</update>
	
	<delete id="DeleteBoard">
		DELETE FROM T_BOARD
		WHERE BOARDNO = @BOARDNO		
	</delete>

	<update id="UpdateBoardView">
		UPDATE T_BOARD
		SET 
			BOARDVIEW=BOARDVIEW+1
		WHERE BOARDNO=@BOARDNO;
	</update>
	
	<select id="SelectBoardReply">
		SELECT
			REPLYID,
			BOARDNO,
			REPLYCONTENTS,
			REPLYCREATETIME,
			BOARDREPLYUSERNAME,
			P_REPLYID
		FROM T_BOARD_REPLY
		WHERE BOARDNO=@BOARDNO
		ORDER BY P_REPLYID, REPLYID ASC
	</select>

	<insert id="InsertBoardReply">
		INSERT INTO T_BOARD_REPLY(BOARDNO, REPLYCONTENTS, REPLYCREATETIME, BOARDREPLYUSERNAME)
		VALUES(@BOARDNO, @ReplyContents, GETDATE(), @BOARDREPLYUSERNAME);
	</insert>
	
	<update id="Update_P_ReplyId">
		UPDATE T_BOARD_REPLY
		SET P_REPLYID = REPLYID
		WHERE P_REPLYID IS NULL
	</update>

	<insert id="InsertBoardReplyReply">
		INSERT INTO T_BOARD_REPLY(BOARDNO, REPLYCONTENTS, REPLYCREATETIME, BOARDREPLYUSERNAME, P_REPLYID)
		VALUES(@BOARDNO, @ReplyContents, GETDATE(), @BOARDREPLYUSERNAME, @P_REPLYID);
	</insert>
</mapper>